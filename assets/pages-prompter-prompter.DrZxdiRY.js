import{_ as e,m as a,r as t,o as s,c as l,w as n,a as o,d as i,t as u,x as r,g as c,i as p,k as d,l as m,y as f,f as v,z as g,A as y,F as w,b as _,B as k,S as h,n as z}from"./index-QkH9l-qM.js";import{_ as x}from"./u-icon.CbdK4gIY.js";import{r as b}from"./uni-app.es.Da86EhfK.js";import{_ as S,u as C}from"./script.BSxtZnhO.js";import{u as P,_ as j}from"./u-popup.B8Bl6blL.js";const D=[{text:"字体",icon:"edit-pen-fill",action:"font"},{text:"速度减",icon:"minus",action:"minus"},{text:"开始",icon:"play-right-fill",action:"play"},{text:"速度加",icon:"plus",action:"plus"},{text:"设置",icon:"setting",action:"setting"}],I=e({__name:"prompterPopup",props:{showPopup:{type:Boolean,default:!1}},emits:["update:showPopup"],setup(e,{emit:d}){const m=e,f=d,v=P(),g=a((()=>v.fontSize)),y=a({get:()=>m.showPopup,set:e=>{f("update:showPopup",e)}}),w=e=>{"plus"==e?v.setFontSize(g.value+2):v.setFontSize(g.value-2)},_=e=>{"plus"==e?v.setSideMargin(v.sideMargin+2):v.setSideMargin(v.sideMargin-2)},k=e=>{"plus"==e?v.setCountdownDuration(v.countdownDuration+1):v.setCountdownDuration(v.countdownDuration-1)};return(e,a)=>{const d=c,m=b(t("u-icon"),x),f=b(t("u-button"),S),h=p,z=b(t("u-popup"),j);return s(),l(z,{modelValue:y.value,"onUpdate:modelValue":a[6]||(a[6]=e=>y.value=e),mode:"bottom","mask-close-able":"",length:"25%","border-radius":"14"},{default:n((()=>[o(h,{style:{padding:"20px",width:"80vw"}},{default:n((()=>[o(h,{class:"font-size-buttons"},{default:n((()=>[o(d,{class:"draw-text-width"},{default:n((()=>[i("字体大小")])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[0]||(a[0]=e=>w("minus"))},{default:n((()=>[o(m,{name:"minus",size:"30"})])),_:1}),o(d,{style:{"font-size":"16px"}},{default:n((()=>[i(u(g.value),1)])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[1]||(a[1]=e=>w("plus"))},{default:n((()=>[o(m,{name:"plus",size:"30"})])),_:1})])),_:1}),o(h,{class:"font-size-buttons"},{default:n((()=>[o(d,{class:"draw-text-width"},{default:n((()=>[i("与边缘的宽度")])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[2]||(a[2]=e=>_("minus"))},{default:n((()=>[o(m,{name:"minus",size:"30"})])),_:1}),o(d,{style:{"font-size":"16px"}},{default:n((()=>[i(u(r(v).sideMargin),1)])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[3]||(a[3]=e=>_("plus"))},{default:n((()=>[o(m,{name:"plus",size:"30"})])),_:1})])),_:1}),o(h,{class:"font-size-buttons"},{default:n((()=>[o(d,{class:"draw-text-width"},{default:n((()=>[i("提词器倒计时")])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[4]||(a[4]=e=>k("minus"))},{default:n((()=>[o(m,{name:"minus",size:"30"})])),_:1}),o(d,{style:{"font-size":"16px"}},{default:n((()=>[i(u(r(v).countdownDuration),1)])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[5]||(a[5]=e=>k("plus"))},{default:n((()=>[o(m,{name:"plus",size:"30"})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-60d1215b"]]),L=e({__name:"prompter",setup(e){const j=C(),L=P(),M=d(!1),F=d(0),$=d(!0),B=d(!1),O=d(3),R=d(!1);let V=null;const A=a((()=>({transform:`scaleX(${L.mirroredX?-1:1}) scaleY(${L.mirroredY?-1:1})`}))),H=a((()=>L.fontSize)),U=a((()=>({fontSize:`${H.value}rpx`,fontFamily:L.fontFamily,textAlign:L.alignment,padding:`0 ${L.sideMargin}%`,boxSizing:"border-box",lineHeight:H.value*L.lineHeightRate+"rpx"}))),X=()=>{if(L.countdownDuration>0){B.value=!0,O.value=L.countdownDuration;const e=setInterval((()=>{O.value--,O.value>0&&(e=>{const a=document.getElementById("progressRing"),t=e/L.countdownDuration*360;a.style.setProperty("--progress",`${t}deg`)})(O.value),O.value<=0&&(clearInterval(e),B.value=!1,Y())}),1e3)}else Y()},Y=()=>{M.value=!0,V=setInterval((()=>{F.value+=.2*L.scrollSpeed}),50)},q=()=>{M.value=!1,V&&(clearInterval(V),V=null)},E=()=>{$.value=!$.value},W=e=>{switch(e){case"list":break;case"minus":L.setScrollSpeed(L.scrollSpeed-.5);break;case"play":M.value?q():X();break;case"plus":L.setScrollSpeed(L.scrollSpeed+.5);break;case"font":R.value=!0;break;case"setting":z({url:"/pages/settings/settings"})}};return m((()=>{"wakeLock"in navigator&&navigator.wakeLock.request("screen").catch((e=>console.error("Wake Lock failed:",e)))})),f((()=>{q(),"wakeLock"in navigator&&window.wakeLockObj&&window.wakeLockObj.release().then((()=>window.wakeLockObj=null))})),(e,a)=>{const d=p,m=c,f=h,z=b(t("u-icon"),x),C=b(t("u-button"),S);return s(),l(d,{class:"prompter-screen"},{default:n((()=>[o(d,{class:"safe-area-top"}),o(d,{class:"text-content",onClick:E},{default:n((()=>[o(d,{class:"text-container",style:v(A.value)},{default:n((()=>[o(f,{"scroll-y":!0,"scroll-top":F.value,class:"scrollable-text",style:v([U.value,{height:"calc(100vh - 44px)"}])},{default:n((()=>[o(m,null,{default:n((()=>[i(u(r(j).text),1)])),_:1})])),_:1},8,["scroll-top","style"])])),_:1},8,["style"]),$.value?(s(),l(d,{key:0,class:"controls"},{default:n((()=>[(s(!0),g(w,null,y(r(D),(e=>(s(),l(d,{key:e.action},{default:n((()=>[o(C,{type:"primary",size:"mini",shape:"circle",onClick:a=>W(e.action),customStyle:{background:"transparent",border:"none",padding:0}},{default:n((()=>["play"==e.action?(s(),l(z,{key:0,name:M.value?"pause":"play-right-fill",size:"30"},null,8,["name"])):(s(),l(z,{key:1,name:e.icon,size:"30"},null,8,["name"]))])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})):_("",!0),B.value?(s(),l(d,{key:1,class:"countdown"},{default:n((()=>[o(d,{class:"countdown-container"},{default:n((()=>[k("div",{class:"progress-background"}),k("div",{class:"progress-ring",id:"progressRing"}),o(m,{class:"countdown-text"},{default:n((()=>[i(u(O.value),1)])),_:1})])),_:1})])),_:1})):_("",!0)])),_:1}),o(r(I),{showPopup:R.value,"onUpdate:showPopup":a[0]||(a[0]=e=>R.value=e)},null,8,["showPopup"])])),_:1})}}},[["__scopeId","data-v-705f69f6"]]);export{L as default};
