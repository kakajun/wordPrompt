import{_ as e,m as a,r as t,o as s,c as l,w as n,a as o,d as i,t as u,x as r,g as c,i as p,k as d,l as m,y as f,f as v,z as g,A as w,F as y,b as k,B as _,C as h,S as z,n as b}from"./index-L0sq5byT.js";import{_ as x}from"./u-icon.CthljDPs.js";import{r as S}from"./uni-app.es.C3AlOrpH.js";import{_ as C,u as P}from"./script.CNGw6gKm.js";import{u as j,_ as D}from"./u-popup.DDkwFiF3.js";const I=[{text:"字体",icon:"edit-pen-fill",action:"font"},{text:"速度减",icon:"minus",action:"minus"},{text:"开始",icon:"play-right-fill",action:"play"},{text:"速度加",icon:"plus",action:"plus"},{text:"设置",icon:"setting",action:"setting"}],L=e({__name:"prompterPopup",props:{showPopup:{type:Boolean,default:!1}},emits:["update:showPopup"],setup(e,{emit:d}){const m=e,f=d,v=j(),g=a((()=>v.fontSize)),w=a({get:()=>m.showPopup,set:e=>{f("update:showPopup",e)}}),y=e=>{"plus"==e?v.setFontSize(g.value+2):v.setFontSize(g.value-2)},k=e=>{"plus"==e?v.setSideMargin(v.sideMargin+2):v.setSideMargin(v.sideMargin-2)},_=e=>{"plus"==e?v.setCountdownDuration(v.countdownDuration+1):v.setCountdownDuration(v.countdownDuration-1)};return(e,a)=>{const d=c,m=S(t("u-icon"),x),f=S(t("u-button"),C),h=p,z=S(t("u-popup"),D);return s(),l(z,{modelValue:w.value,"onUpdate:modelValue":a[6]||(a[6]=e=>w.value=e),mode:"bottom","mask-close-able":"",length:"25%","border-radius":"14"},{default:n((()=>[o(h,{style:{padding:"20px",width:"80vw"}},{default:n((()=>[o(h,{class:"font-size-buttons"},{default:n((()=>[o(d,{class:"draw-text-width"},{default:n((()=>[i("字体大小")])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[0]||(a[0]=e=>y("minus"))},{default:n((()=>[o(m,{name:"minus",size:"30"})])),_:1}),o(d,{style:{"font-size":"16px"}},{default:n((()=>[i(u(g.value),1)])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[1]||(a[1]=e=>y("plus"))},{default:n((()=>[o(m,{name:"plus",size:"30"})])),_:1})])),_:1}),o(h,{class:"font-size-buttons"},{default:n((()=>[o(d,{class:"draw-text-width"},{default:n((()=>[i("与边缘的宽度")])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[2]||(a[2]=e=>k("minus"))},{default:n((()=>[o(m,{name:"minus",size:"30"})])),_:1}),o(d,{style:{"font-size":"16px"}},{default:n((()=>[i(u(r(v).sideMargin),1)])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[3]||(a[3]=e=>k("plus"))},{default:n((()=>[o(m,{name:"plus",size:"30"})])),_:1})])),_:1}),o(h,{class:"font-size-buttons"},{default:n((()=>[o(d,{class:"draw-text-width"},{default:n((()=>[i("提词器倒计时")])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[4]||(a[4]=e=>_("minus"))},{default:n((()=>[o(m,{name:"minus",size:"30"})])),_:1}),o(d,{style:{"font-size":"16px"}},{default:n((()=>[i(u(r(v).countdownDuration),1)])),_:1}),o(f,{type:"primary",size:"mini",shape:"circle",onClick:a[5]||(a[5]=e=>_("plus"))},{default:n((()=>[o(m,{name:"plus",size:"30"})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-60d1215b"]]),M=e({__name:"prompter",setup(e){const D=P(),M=j(),B=d(!1),F=d(0),$=d(!0),O=d(!1),R=d(3),T=d(!1);let V=null;const A=a((()=>({background:M.transparentBackground?"transparent":"#000",color:M.transparentBackground?"#000":"#fff",transform:`scaleX(${M.mirroredX?-1:1}) scaleY(${M.mirroredY?-1:1})`}))),H=a((()=>M.fontSize)),U=a((()=>({fontSize:`${H.value}rpx`,fontFamily:M.fontFamily,textAlign:M.alignment,padding:`0 ${M.sideMargin}%`,boxSizing:"border-box",lineHeight:H.value*M.lineHeightRate+"rpx"}))),X=()=>{if(M.countdownDuration>0){O.value=!0,R.value=M.countdownDuration;const e=setInterval((()=>{R.value--,R.value>0&&(e=>{const a=document.getElementById("progressRing"),t=e/M.countdownDuration*360;a.style.setProperty("--progress",`${t}deg`)})(R.value),R.value<=0&&(clearInterval(e),O.value=!1,Y())}),1e3)}else Y()},Y=()=>{B.value=!0,V=setInterval((()=>{F.value+=.2*M.scrollSpeed}),50)},q=()=>{B.value=!1,V&&(clearInterval(V),V=null)},E=()=>{$.value=!$.value},W=e=>{switch(e){case"list":break;case"minus":M.setScrollSpeed(M.scrollSpeed-.5);break;case"play":B.value?q():X();break;case"plus":M.setScrollSpeed(M.scrollSpeed+.5);break;case"font":T.value=!0;break;case"setting":b({url:"/pages/settings/settings"})}};m((()=>{"wakeLock"in navigator&&navigator.wakeLock.request("screen").catch((e=>console.error("Wake Lock failed:",e)))})),f((()=>{q(),"wakeLock"in navigator&&window.wakeLockObj&&window.wakeLockObj.release().then((()=>window.wakeLockObj=null))}));const G=d(!1),J=e=>{q(),G.value=!0},K=e=>{G.value&&h((function(){F.value=e.detail.scrollTop}))},N=()=>{G.value=!1};return(e,a)=>{const d=p,m=c,f=z,h=S(t("u-icon"),x),b=S(t("u-button"),C);return s(),l(d,{class:"prompter-screen"},{default:n((()=>[o(d,{class:"safe-area-top"}),o(d,{class:"text-content",onClick:E},{default:n((()=>[o(d,{style:v(A.value)},{default:n((()=>[o(f,{"scroll-y":!0,"scroll-top":F.value,class:"scrollable-text",style:v([U.value,{height:"calc(100vh - 44px)"}]),onScroll:K,onTouchstart:J,onTouchend:N,"scroll-with-animation":!1,"enable-flex":!0},{default:n((()=>[o(m,null,{default:n((()=>[i(u(r(D).text),1)])),_:1})])),_:1},8,["scroll-top","style"])])),_:1},8,["style"]),$.value?(s(),l(d,{key:0,class:"controls"},{default:n((()=>[(s(!0),g(y,null,w(r(I),(e=>(s(),l(d,{key:e.action},{default:n((()=>[o(b,{type:"primary",size:"mini",shape:"circle",onClick:a=>W(e.action),customStyle:{background:"transparent",border:"none",padding:0}},{default:n((()=>["play"==e.action?(s(),l(h,{key:0,name:B.value?"pause":"play-right-fill",size:"30"},null,8,["name"])):(s(),l(h,{key:1,name:e.icon,size:"30"},null,8,["name"]))])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})):k("",!0),O.value?(s(),l(d,{key:1,class:"countdown"},{default:n((()=>[o(d,{class:"countdown-container"},{default:n((()=>[_("div",{class:"progress-background"}),_("div",{class:"progress-ring",id:"progressRing"}),o(m,{class:"countdown-text"},{default:n((()=>[i(u(R.value),1)])),_:1})])),_:1})])),_:1})):k("",!0)])),_:1}),o(r(L),{showPopup:T.value,"onUpdate:showPopup":a[0]||(a[0]=e=>T.value=e)},null,8,["showPopup"])])),_:1})}}},[["__scopeId","data-v-468f4072"]]);export{M as default};
